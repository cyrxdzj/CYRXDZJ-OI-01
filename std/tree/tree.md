## 承载梦想的心愿树

![在心愿重合的地方](./card_021_016_normal_compressed.jpg)

### 题目描述

时间限制：2s

空间限制：512MB

Miku 有一棵心愿树。这是一棵有根树，这棵树有 $n$  个节点，编号为从 $1$ 到 $n$ 的正整数，规定 $1$ 号点为树根。每个节点都承载了一个**心愿值**和**饱和度**，第 $i$ 个节点的**心愿值**记为 $a_i$，**饱和度**记为 $b_i$。

同时，定义这棵树的**活力**为 $c$。

上述的 $n$，$a_i$，$b_i$，$c$ 均会在输入数据中给出。

定义 $f(u,v)=|a_u-a_v|\times min(a_u,a_v)\times(b_u\oplus b_v\oplus c)$，对于每个节点 $i$，Miku 想请你计算：
$$
g(i)=\sum_{u\in subtree(i),v\in subtree(i)}f(u,v)
$$
其中，$subtree(i)$ 表示以 $i$ 为根的子树的点集，当然包括 $i$ 自己。

由于这个答案可能很大，请输出 $g(i)\mod998244353$。 

### 输入数据格式

输入文件为 `tree.in`。

第一行有一个正整数 $n$。

接下来的 $n-1$ 行，第 $i$ 行有两个正整数 $u_i$ 和 $v_i$，代表树上 $u_i$ 和 $v_i$ 两点直接连边。

接下来的一行，有 $n$ 个正整数 $a_i$。

接下来的一行，有 $n$ 个整数 $b_i$。

接下来的一行，有一个整数 $c$。

### 输出数据格式

输出文件为 `tree.out`。

输出应有 $n$ 行，每行表示 $g(i)\mod998244353$。

### 样例

#### 样例输入 #1

```input1
5
1 2
1 4
2 5
3 1
11 16 4 15 2
7 5 3 1 1
3
```

#### 样例输出 #1

```output1
2456
392
0
0
0
```

#### 样例 #2

请见 `tree2.in` 和 `tree2.ans`，该样例符合 Subtask 2,3,4 的数据范围与全部特殊性质。

#### 样例 #3

请见 `tree3.in` 和 `tree3.ans`，该样例符合 Subtask 5 的数据范围。

### 数据范围与提示

题中出现的 $\oplus$ 代表“按位异或”。即，考虑操作数的每一个二进制位，如果相同，则结果的数在这个二进制位上为 $0$，否则为 $1$。

例如，$12\oplus10=6$，因为 $(1100)_2\oplus(1010)_2=(0110)_2$。

在 C++ 语言中，你可以使用 `^` 运算符。

可以发现，按位异或运算符合交换律、结合律。

| Subtask | 分值 | $n$              | 更多特殊性质    | 计分方式 |
| ------- | ---- | ---------------- | --------------- | -------- |
| 1       | 4    | $\le 200$        | 无              | 最小值   |
| 2       | 12   | $\le1200$        | 无              | 最小值   |
| 3       | 18   | $\le1\times10^5$ | 所有 $b_i$ 相等 | 总和     |
| 4       | 18   | $\le1\times10^5$ | $u_i=i,v_i=i+1$ | 总和     |
| 5       | 48   | $\le1\times10^5$ | 无              | 总和     |

对于所有数据，保证有 $1\le n\le1\times10^5$，$1\le a_i\le10^9$，$0\le b_i,c\le2^6-1$。

上表中，计分方式为“最小值”意味着你需要通过该 Subtask 下的所有测试点才能获得该 Subtask 下的分数，“总和”意味着你在这个 Subtask 下获得的分数与你在这个 Subtask 中通过的测试点数量成正比。

### 版权信息

题目：[广州市铁一中学 邓子君](https://www.luogu.com.cn/user/387836)

数据：[广州市铁一中学 邓子君](https://www.luogu.com.cn/user/387836)，Powered by [CYaRon](https://github.com/luogu-dev/cyaron)

题面部分内容的版权持有方为 `SEGA Corporation`，`Colorful Palette Inc.`，`Crypton Media Future Inc.`等公司，仅以非商业目的使用。

在 [CC-BY-NC 4.0](https://creativecommons.org/licenses/by-nc/4.0/legalcode.zh-hans) 协议下共享。